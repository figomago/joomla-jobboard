
/**
  @package JobBoard
  @copyright Copyright (c)2010-2013 Figomago <http://figomago.wordpress.com>
  @license : GNU General Public License v3 or later
----------------------------------------------------------------------- */
Fx.Reveal=new Class({Extends:Fx.Morph,options:{link:"cancel",styles:["padding","border","margin"],transitionOpacity:!Browser.Engine.trident4,mode:"vertical",display:function(){return this.element.get("tag")!="tr"?"block":"table-row"},hideInputs:Browser.Engine.trident?"select, input, textarea, object, embed":false,opacity:1},dissolve:function(){try{if(!this.hiding&&!this.showing){if(this.element.getStyle("display")!="none"){this.hiding=true;this.showing=false;this.hidden=true;this.cssText=this.element.style.cssText;var d=this.element.getComputedSize({styles:this.options.styles,mode:this.options.mode});this.element.setStyle("display",$lambda(this.options.display).apply(this));if(this.options.transitionOpacity){d.opacity=this.options.opacity}var b={};$each(d,function(f,e){b[e]=[f,0]},this);this.element.setStyle("overflow","hidden");var a=this.options.hideInputs?this.element.getElements(this.options.hideInputs):null;this.$chain.unshift(function(){if(this.hidden){this.hiding=false;$each(d,function(f,e){d[e]=f},this);this.element.style.cssText=this.cssText;this.element.setStyle("display","none");if(a){a.setStyle("visibility","visible")}}this.fireEvent("hide",this.element);this.callChain()}.bind(this));if(a){a.setStyle("visibility","hidden")}this.start(b)}else{this.callChain.delay(10,this);this.fireEvent("complete",this.element);this.fireEvent("hide",this.element)}}else{if(this.options.link=="chain"){this.chain(this.dissolve.bind(this))}else{if(this.options.link=="cancel"&&!this.hiding){this.cancel();this.dissolve()}}}}catch(c){this.hiding=false;this.element.setStyle("display","none");this.callChain.delay(10,this);this.fireEvent("complete",this.element);this.fireEvent("hide",this.element)}return this},reveal:function(){try{if(!this.showing&&!this.hiding){if(this.element.getStyle("display")=="none"){this.showing=true;this.hiding=this.hidden=false;var d;this.cssText=this.element.style.cssText;this.element.measure(function(){d=this.element.getComputedSize({styles:this.options.styles,mode:this.options.mode})}.bind(this));$each(d,function(f,e){d[e]=f});if($chk(this.options.heightOverride)){d.height=this.options.heightOverride.toInt()}if($chk(this.options.widthOverride)){d.width=this.options.widthOverride.toInt()}if(this.options.transitionOpacity){this.element.setStyle("opacity",0);d.opacity=this.options.opacity}var b={height:0,display:$lambda(this.options.display).apply(this)};$each(d,function(f,e){b[e]=0});this.element.setStyles($merge(b,{overflow:"hidden"}));var a=this.options.hideInputs?this.element.getElements(this.options.hideInputs):null;if(a){a.setStyle("visibility","hidden")}this.start(d);this.$chain.unshift(function(){this.element.style.cssText=this.cssText;this.element.setStyle("display",$lambda(this.options.display).apply(this));if(!this.hidden){this.showing=false}if(a){a.setStyle("visibility","visible")}this.callChain();this.fireEvent("show",this.element)}.bind(this))}else{this.callChain();this.fireEvent("complete",this.element);this.fireEvent("show",this.element)}}else{if(this.options.link=="chain"){this.chain(this.reveal.bind(this))}else{if(this.options.link=="cancel"&&!this.showing){this.cancel();this.reveal()}}}}catch(c){this.element.setStyles({display:$lambda(this.options.display).apply(this),visiblity:"visible",opacity:this.options.opacity});this.showing=false;this.callChain.delay(10,this);this.fireEvent("complete",this.element);this.fireEvent("show",this.element)}return this},toggle:function(){if(this.element.getStyle("display")=="none"){this.reveal()}else{this.dissolve()}return this},cancel:function(){this.parent.apply(this,arguments);this.element.style.cssText=this.cssText;this.hiding=false;this.showing=false;return this}});Element.Properties.reveal={set:function(a){var b=this.retrieve("reveal");if(b){b.cancel()}return this.eliminate("reveal").store("reveal:options",a)},get:function(a){if(a||!this.retrieve("reveal")){if(a||!this.retrieve("reveal:options")){this.set("reveal",a)}this.store("reveal",new Fx.Reveal(this,this.retrieve("reveal:options")))}return this.retrieve("reveal")}};Element.Properties.dissolve=Element.Properties.reveal;Element.implement({reveal:function(a){this.get("reveal",a).reveal();return this},dissolve:function(a){this.get("reveal",a).dissolve();return this},nix:function(){var a=Array.link(arguments,{destroy:Boolean.type,options:Object.type});this.get("reveal",a.options).dissolve().chain(function(){this[a.destroy?"destroy":"dispose"]()}.bind(this));return this},wink:function(){var b=Array.link(arguments,{duration:Number.type,options:Object.type});var a=this.get("reveal",b.options);a.reveal().chain(function(){(function(){a.dissolve()}).delay(b.duration||2000)})}});var MooFlipper=new Class({Implements:[Options],options:{scrollItems:null,itemContainer:null,itemsVisible:5,elemsSlide:null,itemsSelector:null,itemWidth:null,transition:Fx.Transitions.Quart.easeOut,duration:500,direction:1,fwdBtn:null,backBtn:null,mouseWheelNav:false},initialize:function(a){this.setOptions(a);if(this.options.itemContainer!==null){this.itemContainer=$(this.options.itemContainer);this.elements=this.itemContainer.getElements(this.options.itemsSelector);this.totalElements=this.elements.length;if(this.totalElements<=this.options.itemsVisible){return}this.elementWidth=this.options.itemWidth||this.elements[0].getSize().x;this.currentElement=0;this.direction=this.options.direction;this.begin()}},begin:function(){this.setContainersSize();this.inFx=new Fx.Morph(this.options.itemContainer,{transition:this.options.transition,duration:this.options.duration});this.options.fwdBtn.addEvent("click",this.slide.pass(1,this));this.options.backBtn.addEvent("click",this.slide.pass(-1,this));if(this.options.mouseWheelNav){this.itemContainer.addEvent("mousewheel",function(a){a.stop();this.slide(-a.wheel)}.bind(this))}},setContainersSize:function(){var a=this.options.itemsVisible*this.elementWidth;this.elements.each(function(b){b.setStyle("width",a)});this.itemContainer.set({styles:{width:this.totalElements*(this.elementWidth+10)}})},slide:function(c){if(this.started){return}switch(c){case -1:if(this.currentElement==0){return}break;case 1:if(this.currentElement==(this.totalElements-1)){return}break;default:break}this.direction=c;var a=this.currentIndex();if(this.options.elemsSlide&&this.options.elemsSlide>0&&this.endingElem==null){this.endingElem=this.currentElement;for(var b=0;b<this.options.elemsSlide;b++){this.endingElem+=c;if(this.endingElem>=this.totalElements){this.endingElem=0}if(this.endingElem<0){this.endingElem=this.totalElements-1}}}if(this.direction==-1){this.rearange();this.itemContainer.setStyle("margin-left",-this.elementWidth)}this.started=true;this.inFx.start({opacity:[0.2,1],"margin-left":this.direction==1?-this.elementWidth:0}).chain(function(){this.rearange(true);if(this.options.elemsSlide){if(this.endingElem!==this.currentElement){this.slide(this.direction)}else{this.endingElem=null}}if(this.direction==-1){if(this.currentElement==0){this.options.backBtn.addClass("disabled")}if(this.options.fwdBtn.hasClass("disabled")){this.options.fwdBtn.removeClass("disabled")}}if(this.direction==1){if(this.currentElement==(this.totalElements-1)){this.options.fwdBtn.addClass("disabled")}if(this.totalElements>1){if(this.options.backBtn.hasClass("disabled")){this.options.backBtn.removeClass("disabled")}}}}.bind(this))},rearange:function(a){if(a){this.started=false}if(a&&this.direction==-1){return}this.currentElement=this.currentIndex(this.direction);this.itemContainer.setStyle("margin-left",0);if(this.currentElement==1&&this.direction==1){this.elements[0].injectAfter(this.elements[this.totalElements-1]);return}if((this.currentElement==0&&this.direction==1)||(this.direction==-1&&this.currentElement==this.totalElements-1)){this.rearrangeElement(this.elements.getLast(),this.direction==1?this.elements[this.totalElements-2]:this.elements[0]);return}if(this.direction==1){this.rearrangeElement(this.elements[this.currentElement-1],this.elements[this.currentElement-2])}else{this.rearrangeElement(this.elements[this.currentElement],this.elements[this.currentElement+1])}},rearrangeElement:function(b,a){this.direction==1?b.injectAfter(a):b.injectBefore(a)},currentIndex:function(){var a=null;switch(this.direction){case 1:a=this.currentElement>=this.totalElements-1?0:this.currentElement+this.direction;break;case -1:a=this.currentElement==0?this.totalElements-1:this.currentElement+this.direction;break}return a}});var TandolinJobFilter=new Class({Implements:[Options,Events],options:{texfieldDefaults:"texfield_defaults",keywdsContent:"keywds-content",catLoader:"category-filter",toggleClassName:"div.filterToggle",catFiltercontrols:"catFiltercontrols",cbSections:[],effects:{reveal:[]}},initialize:function(a){this.setOptions(a);this.tfDefaults=$(this.options.texfieldDefaults);this.tfDefaultsFirst=this.tfDefaults.getFirst("input");this.defltTxtFields=[];this.defltTxtFields.jobsearch=this.tfDefaultsFirst.value;this.defltTxtFields.keysrch=this.tfDefaultsFirst.getNext().value;this.tfDiv=$(this.options.keywdsContent).getFirst("div");this.tfActnsDiv=this.tfDiv.getLast("div");this.parentForm=this.tfDiv.getParent("form");this.tFields=this.tfDiv.getElements("input[type=text]");this.catLoader=$(this.options.catLoader).getLast("span");this.tfReset=this.tfActnsDiv.getLast("a");this.cbSections=this.options.cbSections;this.effects=this.options.effects;this.begin()},begin:function(){this.instFlipper=null;this.setTxtFieldEvents(this.tFields,this.tfReset,this.catLoader);this.tfActnsDiv.getFirst("input").addEvent("click",function(a){a.stop();if(this.tFields[0].value.length<1&&this.tFields[1].value.length<1){return}else{this.catLoader.removeClass("hidden");this.parentForm.submit()}}.bind(this));$$(this.options.toggleClassName).each(function(a){this.initFilterToggle(a)}.bind(this))},setTxtFieldEvents:function(b,c,a){b.each(function(d){d.addEvents({focus:function(){this.parseTxtFields(b,c)}.bind(this),blur:function(){this.parseTxtFields(b,c)}.bind(this),keyup:function(){this.parseTxtFields(b,c)}.bind(this)})}.bind(this));c.addEvent("click",function(d){d.stop();b.each(function(e){e.value=""});a.removeClass("hidden");this.parentForm.submit()}.bind(this))},parseTxtFields:function(e,d){var b=e[0].value,a=e[1].value,c=d.hasClass("hidden");if(b!=""||a!=""&&c){d.removeClass("hidden")}if(b==""&&a==""&&!c){d.addClass("hidden")}},initFilterToggle:function(n){var o=n.getFirst("div"),h=n.getNext("div"),m=h.getElement("ul");if(m){var f=m.getLast("li"),a=f.getLast();if(a.match(".chk_filter[type=submit]")){this.cbSections[h.id]=0;if(o.hasClass("stateOpen")){var i=n.getLast("span"),c=f.getElement("a");this.cbSections[h.id]=1;this.setSubmitEvent(a,i);this.setCbClearEvent(c,i,h);this.setCbEvents(h,c)}}else{if(m.hasClass("hrefSelects")){if(o.hasClass("stateOpen")){var i=n.getLast("span");var l=h.getFirst("a");var g=l.getAttribute("title").split("-");l.addEvent("click",function(q){q.stop();this.parentForm.getElement("input[name="+g[0]+"]").value=g[1];i.removeClass("hidden");this.parentForm.submit()}.bind(this));var b=m.getElements("a[class=close]");var k;if(b.length>0){var p=b[0].getAttribute("title").split("-"),k=p[0];b.each(function(q){this.setSelectLinkEvents(q,p,i)}.bind(this))}f.getLast().addEvent("click",function(q){q.stop();this.parentForm.getElement("input[name="+k+"]").value=0;i.removeClass("hidden");this.parentForm.submit()}.bind(this))}}else{if(m.hasClass("filter-catitem")){var i=n.getLast("span"),d=m.getParent("div"),e=d.getElements("a"),l=h.getFirst("a");if(e.length>0){e.each(function(q){q.addEvent("click",function(){i.removeClass("hidden")})})}l.addEvent("click",function(){i.removeClass("hidden")})}else{var i=n.getLast("span");f.getLast().addEvent("click",function(){i.removeClass("hidden")}.bind(this))}}}}var j=n.id.split("-");n.addEvent("click",function(){this.setToggle(j[0])}.bind(this))},setToggle:function(h){var a=$(h+"-filter"),d=$(h+"-toggle"),g=$(h+"-content"),r=g.getElement("ul");if(r){var i=r.getLast("li")}else{r={}}var c=i.getLast(),m=c.match(".chk_filter[type=submit]"),o=a.getLast("span"),q=r.hasClass("hrefSelects");if(d.hasClass("stateOpen")){d.removeClass("stateOpen");d.addClass("stateClosed");if(m==true){c.removeEvents();i.getElements("a").removeEvents()}else{if(r.hasClass("filter-catitem")){this.instFlipper=null}}}else{d.addClass("stateOpen");d.removeClass("stateClosed");if(m==true){var n=i.getElement("a");this.setSubmitEvent(c,o);this.setCbClearEvent(n,o,g);this.setCbEvents(g,n)}else{if(q===true){var s=r.getElements("a[class=hrefSelect]");var k;if(s.length>0){s.each(function(v){var u=v.getAttribute("title").split("-");k=u[0];this.setSelectLinkEvents(v,u,o)}.bind(this))}i.getLast().addEvent("click",function(u){u.stop();this.parentForm.getElement("input[name="+k+"]").value=0;o.removeClass("hidden");this.parentForm.submit()}.bind(this))}else{if(r.hasClass("filter-catitem")){var j=r.getParent("div");if(j.hasClass("scrollItems")){var l=$(this.options.catFiltercontrols),p=l.getFirst(),f=l.getLast(),b=parseInt(g.getParent("div").getSize().x)-12,t=j.getElements("a"),e=g.getFirst("a");this.instFlipper=new MooFlipper({scrollItems:g.id,itemContainer:h+"-scrollItems",itemsVisible:1,elemsSlide:1,duration:450,itemWidth:b,itemsSelector:".filter-catitem",fwdBtn:f,backBtn:p});if(t.length>0){t.each(function(u){u.addEvent("click",function(){o.removeClass("hidden")})})}e.addEvent("click",function(){o.removeClass("hidden")})}}else{i.getLast().addEvent("click",function(){o.removeClass("hidden")})}}}}this.activateReveal(h,g)},activateReveal:function(a,b){this.effects.reveal[a]=new Fx.Reveal(b).toggle()},setSelectLinkEvents:function(c,b,a){c.addEvent("click",function(d){d.stop();this.parentForm.getElement("input[name="+b[0]+"]").value=b[1];a.removeClass("hidden");this.parentForm.submit()}.bind(this))},setSubmitEvent:function(b,a){b.addEvent("click",function(c){c.stop();a.removeClass("hidden");b.removeEvents();b.setAttribute("disabled","disabled");this.parentForm.submit()}.bind(this))},setCbClearEvent:function(b,a,c){b.addEvent("click",function(d){d.stop();this.clearCboxes(c);this.parentForm.getElement("input[name=cb_reset]").value=1;if(this.cbSections[c.id]==1){a.removeClass("hidden");this.parentForm.submit()}else{b.addClass("hidden")}}.bind(this))},clearCboxes:function(d){var c=d.getElements("input[type=checkbox]");if(!c){return}var b=c.length;if(!b){c.checked=0}else{for(var a=0;a<b;a++){c[a].checked=0;c[a].removeAttribute("checked")}}},hasActiveCbFilters:function(e){var c=e.getElements("input[type=checkbox]");var d=false;if(!c){return}var b=c.length;if(!b){c.checked=0;d=true}else{for(var a=0;a<b;a++){if(c[a].checked==1){d=true}}}return d},setCbEvents:function(c,a){var b=c.getElements("input[type=checkbox]");b.each(function(d){this.runCbLoaderEvt(d,c,a)}.bind(this))},runCbLoaderEvt:function(a,c,b){a.addEvent("click",function(){if(this.hasActiveCbFilters(c)==true){b.removeClass("hidden")}else{b.addClass("hidden")}}.bind(this))}});var Tandolin=Tandolin||{};Tandolin.moduleFilter=Tandolin.moduleFilter||{};window.addEvent("domready",function(){Tandolin.moduleFilter.JobFilter=new TandolinJobFilter()});